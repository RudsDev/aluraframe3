{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_service","NegociacaoService","_listagem","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_init","Object","freeze","event","preventDefault","negociacao","_criarNegociacao","cadastrar","then","adiciona","texto","mensagem","_limpaFormulario","catch","erro","apagar","esvaziarLista","importar","negociacoes","forEach","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus","listar","setInterval","console","log","importarNegociacoes"],"mappings":";;;;;;IAAMA,oB;AAEF,oCAAa;AAAA;;AAET,YAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;;AAEA,aAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,aAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,aAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;;AAEA,aAAKO,QAAL,GAAgB,IAAIC,iBAAJ,EAAhB;;AAEA,aAAKC,SAAL,GAAiB,IAAIC,IAAJ,CAAS,IAAIC,gBAAJ,EAAT,EACI,IAAIC,eAAJ,CAAoBZ,EAAE,kBAAF,CAApB,CADJ,EAEW,UAFX,EAEuB,SAFvB,CAAjB;;AAIA,aAAKa,SAAL,GAAiB,IAAIH,IAAJ,CAAS,IAAII,QAAJ,EAAT,EACS,IAAIC,YAAJ,CAAiBf,EAAE,eAAF,CAAjB,CADT,EAES,OAFT,CAAjB;AAGA,aAAKgB,KAAL;;AAEAC,eAAOC,MAAP,CAAc,IAAd;AAEH;;;;iCAEQC,K,EAAM;AAAA;;AAEXA,kBAAMC,cAAN;;AAEA,gBAAIC,aAAa,KAAKC,gBAAL,EAAjB;;AAEA,iBAAKf,QAAL,CAAcgB,SAAd,CAAwBF,UAAxB,EACKG,IADL,CACU,oBAAY;AACd,sBAAKf,SAAL,CAAegB,QAAf,CAAwBJ,UAAxB;AACA,sBAAKR,SAAL,CAAea,KAAf,GAAuBC,QAAvB;AACA,sBAAKC,gBAAL;AACH,aALL,EAMKC,KANL,CAMW;AAAA,uBAAQ,MAAKhB,SAAL,CAAea,KAAf,GAAuBI,IAA/B;AAAA,aANX;AAOH;;;wCAEc;AAAA;;AAEX,iBAAKvB,QAAL,CAAcwB,MAAd,GACCP,IADD,CACM,oBAAY;AACd,uBAAKX,SAAL,CAAea,KAAf,GAAuBC,QAAvB;AACA,uBAAKlB,SAAL,CAAeuB,aAAf;AACH,aAJD,EAKCH,KALD,CAKO;AAAA,uBAAQ,OAAKhB,SAAL,CAAea,KAAf,GAAuBI,IAA/B;AAAA,aALP;AAMH;;;8CAEqB;AAAA;;AAElB,iBAAKvB,QAAL,CACK0B,QADL,CACc,KAAKxB,SAAL,CAAeyB,WAD7B,EAEKV,IAFL,CAEU;AAAA,uBAAeU,YAAYC,OAAZ,CAAoB,sBAAc;AACnD,2BAAK1B,SAAL,CAAegB,QAAf,CAAwBJ,UAAxB;AACA,2BAAKR,SAAL,CAAea,KAAf,GAAuB,mCAAvB;AACH,iBAHoB,CAAf;AAAA,aAFV,EAMKG,KANL,CAMW;AAAA,uBAAQ,OAAKhB,SAAL,CAAea,KAAf,GAAuBI,IAA/B;AAAA,aANX;AAOH;;;2CAEiB;AACd,mBAAO,IAAIM,UAAJ,CACHC,WAAWC,aAAX,CAAyB,KAAKlC,UAAL,CAAgBmC,KAAzC,CADG,EAEHC,SAAS,KAAKnC,gBAAL,CAAsBkC,KAA/B,CAFG,EAGHE,WAAW,KAAKnC,WAAL,CAAiBiC,KAA5B,CAHG,CAAP;AAIC;;;2CAEa;AACd,iBAAKnC,UAAL,CAAgBmC,KAAhB,GAAwB,EAAxB;AACA,iBAAKlC,gBAAL,CAAsBkC,KAAtB,GAA8B,CAA9B;AACA,iBAAKjC,WAAL,CAAiBiC,KAAjB,GAAyB,GAAzB;AACA,iBAAKnC,UAAL,CAAgBsC,KAAhB;AACH;;;gCAEM;AAAA;;AAEH,iBAAKnC,QAAL,CAAcoC,MAAd,GACCnB,IADD,CACM;AAAA,uBACFU,YAAYC,OAAZ,CAAoB;AAAA,2BACpB,OAAK1B,SAAL,CAAegB,QAAf,CAAwBJ,UAAxB,CADoB;AAAA,iBAApB,CADE;AAAA,aADN,EAKCQ,KALD,CAKO,gBAAQ;AACX,uBAAKhB,SAAL,CAAea,KAAf,GAAuBI,IAAvB;AACH,aAPD;;AASAc,wBAAY,YAAI;AACZC,wBAAQC,GAAR,CAAY,wBAAZ;AACA,uBAAKC,mBAAL;AACH,aAHD,EAGE,IAHF;AAIH","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\r\n\r\n    constructor(){\r\n\r\n        let $ = document.querySelector.bind(document);\r\n\r\n        this._inputData = $('#data');\r\n        this._inputQuantidade = $('#quantidade');\r\n        this._inputValor = $('#valor');\r\n\r\n        this._service = new NegociacaoService();\r\n\r\n        this._listagem = new Bind(new ListaNegociacoes(),\r\n                             new NegociacoesView($('#negociacoesView')),\r\n                                    'adiciona', 'esvazia');\r\n      \r\n        this._mensagem = new Bind(new Mensagem(),\r\n                                  new MensagemView($('#mensagemView')),\r\n                                  'texto');       \r\n        this._init(); \r\n\r\n        Object.freeze(this);\r\n\r\n    }\r\n                                \r\n    adiciona(event){\r\n        \r\n        event.preventDefault();\r\n\r\n        let negociacao = this._criarNegociacao();\r\n\r\n        this._service.cadastrar(negociacao)\r\n            .then(mensagem => {\r\n                this._listagem.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem;\r\n                this._limpaFormulario();\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n    \r\n    esvaziarLista(){\r\n\r\n        this._service.apagar()\r\n        .then(mensagem => {\r\n            this._mensagem.texto = mensagem;\r\n            this._listagem.esvaziarLista();\r\n        })\r\n        .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n    \r\n    importarNegociacoes() {\r\n        \r\n        this._service\r\n            .importar(this._listagem.negociacoes)\r\n            .then(negociacoes => negociacoes.forEach(negociacao => {\r\n                this._listagem.adiciona(negociacao);\r\n                this._mensagem.texto = 'Negociações do período importadas';   \r\n            }))\r\n            .catch(erro => this._mensagem.texto = erro);                        \r\n    }\r\n    \r\n    _criarNegociacao(){\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value));\r\n        }\r\n        \r\n    _limpaFormulario(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 0;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n    \r\n    _init(){\r\n        \r\n        this._service.listar()\r\n        .then(negociacoes => \r\n            negociacoes.forEach(negociacao =>\r\n            this._listagem.adiciona(negociacao))\r\n        )\r\n        .catch(erro => {\r\n            this._mensagem.texto = erro;\r\n        })\r\n\r\n        setInterval(()=>{\r\n            console.log('Importando Negociações');\r\n            this.importarNegociacoes();\r\n        },3000);\r\n    }\r\n}"]}
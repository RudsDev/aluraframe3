{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","Negociacao","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_service","_listagem","_mensagem","_init","Object","freeze","event","preventDefault","negociacao","_criarNegociacao","cadastrar","then","adiciona","texto","mensagem","_limpaFormulario","catch","erro","apagar","esvaziarLista","importar","negociacoes","forEach","textoParaData","value","parseInt","parseFloat","focus","listar","setInterval","console","log","importarNegociacoes"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["\r\nimport {ListaNegociacoes} from \"../models/ListaNegociacoes\";\r\nimport {Mensagem} from \"../models/Mensagem\";\r\nimport {Negociacao} from \"../models/Negociacao\";\r\nimport {NegociacoesView} from \"../views/NegociacoesView\";\r\nimport {MensagemView} from \"../views/MensagemView\";\r\nimport {NegociacaoService} from \"../services/NegociacaoService\";\r\nimport {DateHelper} from \"../helpers/DateHelper\";\r\nimport {Bind} from \"../services/Bind\";\r\n\r\nexport class NegociacaoController {\r\n\r\n    constructor(){\r\n\r\n        let $ = document.querySelector.bind(document);\r\n\r\n        this._inputData = $('#data');\r\n        this._inputQuantidade = $('#quantidade');\r\n        this._inputValor = $('#valor');\r\n\r\n        this._service = new NegociacaoService();\r\n\r\n        this._listagem = new Bind(new ListaNegociacoes(),\r\n                             new NegociacoesView($('#negociacoesView')),\r\n                                    'adiciona', 'esvazia');\r\n      \r\n        this._mensagem = new Bind(new Mensagem(),\r\n                                  new MensagemView($('#mensagemView')),\r\n                                  'texto');       \r\n        this._init(); \r\n\r\n        Object.freeze(this);\r\n\r\n    }\r\n                                \r\n    adiciona(event){\r\n        \r\n        event.preventDefault();\r\n\r\n        let negociacao = this._criarNegociacao();\r\n\r\n        this._service.cadastrar(negociacao)\r\n            .then(mensagem => {\r\n                this._listagem.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem;\r\n                this._limpaFormulario();\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n    \r\n    esvaziarLista(){\r\n\r\n        this._service.apagar()\r\n        .then(mensagem => {\r\n            this._mensagem.texto = mensagem;\r\n            this._listagem.esvaziarLista();\r\n        })\r\n        .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n    \r\n    importarNegociacoes() {\r\n        \r\n        this._service\r\n            .importar(this._listagem.negociacoes)\r\n            .then(negociacoes => negociacoes.forEach(negociacao => {\r\n                this._listagem.adiciona(negociacao);\r\n                this._mensagem.texto = 'Negociações do período importadas';   \r\n            }))\r\n            .catch(erro => this._mensagem.texto = erro);                        \r\n    }\r\n    \r\n    _criarNegociacao(){\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value));\r\n        }\r\n        \r\n    _limpaFormulario(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 0;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n    \r\n    _init(){\r\n        \r\n        this._service.listar()\r\n        .then(negociacoes => \r\n            negociacoes.forEach(negociacao =>\r\n            this._listagem.adiciona(negociacao))\r\n        )\r\n        .catch(erro => {\r\n            this._mensagem.texto = erro;\r\n        })\r\n\r\n        setInterval(()=>{\r\n            console.log('Importando Negociações');\r\n            this.importarNegociacoes();\r\n        },3000);\r\n    }\r\n}"]}